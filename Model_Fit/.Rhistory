geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
geom_point(data = MOV, aes(x = t, y = location, color = "window", size = I(2))) +
geom_point(data = Region, aes(x = DecYear - 1980, y = V1, size = I(2)))
load("est.Rdata")
plot_para(est[[1]][[1]], est[[1]][[2]],est[[1]][[3]],MOV=MOV[[1]],Region=Region_list[[1]],n=1,ignore=c("s_fit","single_fit"))
source("plot_para.R")
plot_para(est[[1]][[1]], est[[1]][[2]],est[[1]][[3]],MOV=MOV[[1]],Region=Region_list[[1]],n=1,ignore=c("s_fit","single_fit"))
View(plot_para)
View(plot_para)
library(tidyverse)
View(plot_para)
plot_para(est[[1]][[1]], est[[1]][[2]],est[[1]][[3]],MOV=MOV[[1]],Region=Region_list[[1]],n=1,ignore=c("s_fit","single_fit"))
View(plot_para)
plot_para <- function(est_mu, est_sig, est_sh, MOV, Region, n = 1, ignore = "best_fit") {
p1 <- est_mu %>%
dplyr::filter(!Group %in% ignore) %>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
geom_point(data = MOV, aes(x = t, y = location, color = "window", size = I(2))) +
geom_point(data = Region, aes(x = DecYear - 1980, y = V1, size = I(2))) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(mu(t)))+
p2 <- est_sig %>%
dplyr::filter(!Group %in% ignore) %>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(sigma(t)))
p3 <- est_sh %>%
dplyr::filter(!Group %in% ignore) %>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(xi(t)))
p <- list(p1, p2, p3)
#  p <- grid.arrange(p1,p2,p3,nrow=3)
#  ggsave(paste0("Region",n,".png"),p,path="F:/Streamflow/Plot/Fit",width=6,height=6)
return(p)
}
plot_para(est[[1]][[1]], est[[1]][[2]],est[[1]][[3]],MOV=MOV[[1]],Region=Region_list[[1]],n=1,ignore=c("s_fit","single_fit"))
detach("package:dplyr")
plot_para(est[[1]][[1]], est[[1]][[2]],est[[1]][[3]],MOV=MOV[[1]],Region=Region_list[[1]],n=1,ignore=c("s_fit","single_fit"))
plot_para <- function(est_mu, est_sig, est_sh, MOV, Region, n = 1, ignore = "best_fit") {
p1 <- est_mu %>%
filter(!Group %in% ignore) %>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
geom_point(data = MOV, aes(x = t, y = location, color = "window", size = I(2))) +
geom_point(data = Region, aes(x = DecYear - 1980, y = V1, size = I(2))) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(mu(t)))+
p2 <- est_sig %>%
filter(!Group %in% ignore) %>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(sigma(t)))
p3 <- est_sh %>%
filter(!Group %in% ignore) %>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(xi(t)))
p <- list(p1, p2, p3)
#  p <- grid.arrange(p1,p2,p3,nrow=3)
#  ggsave(paste0("Region",n,".png"),p,path="F:/Streamflow/Plot/Fit",width=6,height=6)
return(p)
}
detach("package:dplyr")
plot_para(est[[1]][[1]], est[[1]][[2]],est[[1]][[3]],MOV=MOV[[1]],Region=Region_list[[1]],n=1,ignore=c("s_fit","single_fit"))
library(dplyr)
plot_para(est[[1]][[1]], est[[1]][[2]],est[[1]][[3]],MOV=MOV[[1]],Region=Region_list[[1]],n=1,ignore=c("s_fit","single_fit"))
detach("package:dplyr", unload = TRUE)
shiny::runApp()
runApp()
runApp()
runApp()
setwd("F:/StreamFlow/Model_Fit")
load("est.Rdata")
load("MOV.Rdata")
source("plot_para.R")
library(shiny)
library(tidyverse)
library(rlang)
library(gridExtra)
setwd("F:/Streamflow/code/")
source("CI.R")
source("cut_breakpoint.R")
source("fit_abrupt.R")
source("fit_linear.R")
source("fit_quad.R")
source("Moving_window.R")
source("ll.R")
source("graph_data.R")
source("plot_para.R")
library(data.table)
library(tidyverse)
library(ismev)
library(gridExtra)
setwd("F:\\StreamFlow")
load("Stream.Rdata")
Stream <- Stream[Q >= 0]
Stream_plot <- Stream[, c("Site", "Q", "DecYear", "Month", "Region")]
index <- Region_name[-(19:21), 2]
#### define breakpoint ####
point <- data.frame(
mu = c(16, 20, 20, 30, 20, 20, 16, 20, 16, 20, 16, 20, 20, 16, 20, 25, 27, 20),
sig = c(20, 30, 25, 20, 20, 27, 16, 20, 20, 20, 20, 20, 16, 16, 25, 26, 25, 20),
sh = c(15, 30, 22, 20, 14, 18, 25, 25, 20, 16, 20, 20, 20, 20, 25, 25, 25, 25)
)
MOV <- list()
gra <- list()
Region_list <- list()
est <- list()
for (i in 1:18) {
assign("Region", Stream_plot[Region == index[i]][, max(Q), by = DecYear])
Region_list[[i]] <- Region
# MOV
MOV[[i]] <- Moving_window(
x = Region, win = 10, url = "F:/StreamFlow/Plot/Moving_Windows",
save = FALSE, name = quote(Region1)
)
x <- Region$V1
fit1 <- fit_linear(x, point[i, 1], point[i, 2], point[i, 3])
fit2 <- fit_quad(x)
fit3 <- fit_abrupt(x, point[i, 1], point[i, 2], point[i, 3])
fit_list <- list(fit1[[1]], fit1[[2]], fit1[[3]], fit1[[4]], fit2, fit3)
est[[i]] <- graph_data(
fit_list,
c("best_fit", "s_fit", "single_fit", "double_fit", "quad_fit", "abrupt_fit")
)}
View(graph_data)
MOV <- list()
gra <- list()
Region_list <- list()
est <- list()
for (i in 1:18) {
assign("Region", Stream_plot[Region == index[i]][, max(Q), by = DecYear])
Region_list[[i]] <- Region
# MOV
MOV[[i]] <- Moving_window(
x = Region, win = 10, url = "F:/StreamFlow/Plot/Moving_Windows",
save = FALSE, name = quote(Region1)
)
x <- Region$V1
fit1 <- fit_linear(x, point[i, 1], point[i, 2], point[i, 3])
fit2 <- fit_quad(x)
fit3 <- fit_abrupt(x, point[i, 1], point[i, 2], point[i, 3])
fit_list <- list(fit1[[1]], fit1[[2]], fit1[[3]], fit1[[4]], fit2, fit3)
est[[i]] <- graph_data(
fit_list,
c("best_fit", "s_fit", "single_fit", "double_fit", "quad_fit", "abrupt_fit")
)}
View(graph_data)
getwd()
save(est,MOV,Region_list, file="/Model_fit/fit.Rdata")
save(est,MOV,Region_list, file="\\Model_fit\\fit.Rdata")
save(est,MOV,Region_list, file="\\Model_Fit\\fit.Rdata")
setwd("F:/StreamFlow/Model_Fit")
save(est,MOV,Region_list, file="fit.Rdata")
load("fit.Rdata")
source("plot_para.R")
gra <- list()
for (i in 1:18){
gra[[i]] <- plot_para(
est[[i]][[1]], est[[i]][[2]], est[[i]][[3]],
MOV=MOV[[i]],
Region=Region[[i]],
n=i
)
}
est[[i]][[1]]
est[[1]][[1]]%>%
filter(!Group %in% ignore)
library(tidyverse)
est[[1]][[1]]%>%
filter(!Group %in% ignore)
est[[1]][[1]]%>%
filter(!Group %in% "best_fit")
for (i in 1:18){
gra[[i]] <- plot_para(
est[[i]][[1]], est[[i]][[2]], est[[i]][[3]],
MOV=MOV[[i]],
Region=Region[[i]],
n=i,ignore = "best_fit"
)
}
ignore = "best_fit"
est[[1]][[1]]%>%
filter(!Group %in% "best_fit")
plot_para <- function(est_mu, est_sig, est_sh, MOV, Region, n = 1, ignore = "best_fit") {
p1 <- est_mu %>%
dplyr::filter(!Group %in% ignore) %>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
geom_point(data = MOV, aes(x = t, y = location, color = "window", size = I(2))) +
geom_point(data = Region, aes(x = DecYear - 1980, y = V1, size = I(2))) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(mu(t)))+
p2 <- est_sig %>%
dplyr::filter(!Group %in% ignore) %>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(sigma(t)))
p3 <- est_sh %>%
dplyr::filter(!Group %in% ignore) %>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(xi(t)))
p <- list(p1, p2, p3)
#  p <- grid.arrange(p1,p2,p3,nrow=3)
#  ggsave(paste0("Region",n,".png"),p,path="F:/Streamflow/Plot/Fit",width=6,height=6)
return(p)
}
gra <- list()
for (i in 1:18){
gra[[i]] <- plot_para(
est[[i]][[1]], est[[i]][[2]], est[[i]][[3]],
MOV=MOV[[i]],
Region=Region[[i]],
n=i,ignore = "best_fit"
)
}
est[[1]][[1]]%>%
filter(!Group %in% "best_fit")
est[[1]][[1]]%>%
filter(!Group %in% ignore)
for (i in 1:18){
gra[[i]] <- plot_para(
est[[i]][[1]], est[[i]][[2]], est[[i]][[3]],
MOV=MOV[[i]],
Region=Region[[i]],
n=i,ignore = "best_fit"
)
}
est[[1]][[1]]%>%
stats::filter(!Group %in% ignore)
est[[1]][[1]]%>%
dplyr::filter(!Group %in% ignore)
gra <- list()
for (i in 1:18){
gra[[i]] <- plot_para(
est[[i]][[1]], est[[i]][[2]], est[[i]][[3]],
MOV=MOV[[i]],
Region=Region[[i]],
n=i,ignore = c("double_fit","single_fit"))
)
}
gra <- list()
for (i in 1:18){
gra[[i]] <- plot_para(
est[[i]][[1]], est[[i]][[2]], est[[i]][[3]],
MOV=MOV[[i]],
Region=Region[[i]],
n=i,ignore = c("double_fit","single_fit")
)
}
gra <- list()
for (i in 1:18){
gra[[i]] <- plot_para(
est[[i]][[1]], est[[i]][[2]], est[[i]][[3]],
MOV=MOV[[i]],
Region=Region[[i]],
n=i,ignore = c("double_fit","single_fit")
)
}
est[[1]][[1]]
dplyr::filter(Group %in% ignore)
est[[1]][[1]]%>%
dplyr::filter(Group %in% ignore)
plot_para <- function(est_mu, est_sig, est_sh, MOV, Region, n = 1, ignore = "best_fit") {
p1 <- est_mu %>%
dplyr::filter(Group %in% ignore) %>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
geom_point(data = MOV, aes(x = t, y = location, color = "window", size = I(2))) +
geom_point(data = Region, aes(x = DecYear - 1980, y = V1, size = I(2))) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(mu(t)))+
p2 <- est_sig %>%
dplyr::filter(Group %in% ignore) %>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(sigma(t)))
p3 <- est_sh %>%
dplyr::filter(Group %in% ignore) %>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(xi(t)))
p <- list(p1, p2, p3)
#  p <- grid.arrange(p1,p2,p3,nrow=3)
#  ggsave(paste0("Region",n,".png"),p,path="F:/Streamflow/Plot/Fit",width=6,height=6)
return(p)
}
gra <- list()
for (i in 1:18){
gra[[i]] <- plot_para(
est[[i]][[1]], est[[i]][[2]], est[[i]][[3]],
MOV=MOV[[i]],
Region=Region[[i]],
n=i,ignore = c("double_fit","single_fit")
)
}
est[[1]][[1]][which(est[[1]][[1]]$Group %in% ignore),]
plot_para <- function(est_mu, est_sig, est_sh, MOV, Region, n = 1, ignore = "best_fit") {
p1 <- est_mu[which(est_mu$Group %in% ignore),] %>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
geom_point(data = MOV, aes(x = t, y = location, color = "window", size = I(2))) +
geom_point(data = Region, aes(x = DecYear - 1980, y = V1, size = I(2))) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(mu(t)))+
p2 <- est_sig[which(est_sig$Group %in% ignore),] %>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(sigma(t)))
p3 <- est_sh[which(est_sh$Group %in% ignore),]%>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(xi(t)))
p <- list(p1, p2, p3)
#  p <- grid.arrange(p1,p2,p3,nrow=3)
#  ggsave(paste0("Region",n,".png"),p,path="F:/Streamflow/Plot/Fit",width=6,height=6)
return(p)
}
gra <- list()
for (i in 1:18){
gra[[i]] <- plot_para(
est[[i]][[1]], est[[i]][[2]], est[[i]][[3]],
MOV=MOV[[i]],
Region=Region[[i]],
n=i,ignore = c("double_fit","single_fit")
)
}
plot_para <- function(est_mu, est_sig, est_sh, MOV, Region, n = 1, ignore = "best_fit") {
library(tidyverse)
p1 <- est_mu[which(est_mu$Group %in% ignore),] %>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
geom_point(data = MOV, aes(x = t, y = location, color = "window", size = I(2))) +
geom_point(data = Region, aes(x = DecYear - 1980, y = V1, size = I(2))) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(mu(t)))+
p2 <- est_sig[which(est_sig$Group %in% ignore),] %>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(sigma(t)))
p3 <- est_sh[which(est_sh$Group %in% ignore),]%>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(xi(t)))
p <- list(p1, p2, p3)
#  p <- grid.arrange(p1,p2,p3,nrow=3)
#  ggsave(paste0("Region",n,".png"),p,path="F:/Streamflow/Plot/Fit",width=6,height=6)
return(p)
}
gra <- list()
for (i in 1:18){
gra[[i]] <- plot_para(
est[[i]][[1]], est[[i]][[2]], est[[i]][[3]],
MOV=MOV[[i]],
Region=Region[[i]],
n=i,ignore = c("double_fit","single_fit")
)
}
est_mu <- est[[1]][[1]]
est_mu[which(est_mu$Group %in% ignore),] %>%
ggplot(aes(x = t, y = est))
View(est_mu)
est_mu[which(est_mu$Group %in% ignore),] %>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1)))
est_mu[which(est_mu$Group %in% ignore),] %>%
ggplot(aes(x = t, y = est))
tempdir()
plot_para <- function(est_mu, est_sig, est_sh, MOV, Region, n = 1, ignore = "best_fit") {
library(tidyverse)
est_mu <- est[[1]][[1]]
p1 <- est_mu[which(est_mu$Group %in% ignore),] %>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
geom_point(data = MOV, aes(x = t, y = location, color = "window", size = I(2))) +
geom_point(data = Region, aes(x = DecYear - 1980, y = V1, size = I(2))) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(mu(t)))
p2 <- est_sig[which(est_sig$Group %in% ignore),] %>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(sigma(t)))
p3 <- est_sh[which(est_sh$Group %in% ignore),]%>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(xi(t)))
p <- list(p1, p2, p3)
#  p <- grid.arrange(p1,p2,p3,nrow=3)
#  ggsave(paste0("Region",n,".png"),p,path="F:/Streamflow/Plot/Fit",width=6,height=6)
return(p)
}
gra <- list()
for (i in 1:18){
gra[[i]] <- plot_para(
est[[i]][[1]], est[[i]][[2]], est[[i]][[3]],
MOV=MOV[[i]],
Region=Region[[i]],
n=i,ignore = c("double_fit","single_fit")
)
}
plot_para <- function(est_mu, est_sig, est_sh, MOV, Region, n = 1, ignore = "best_fit") {
p1 <- est_mu[which(est_mu$Group %in% ignore),] %>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
geom_point(data = MOV, aes(x = t, y = location, color = "window", size = I(2))) +
geom_point(data = Region, aes(x = DecYear - 1980, y = V1, size = I(2))) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(mu(t)))
p2 <- est_sig[which(est_sig$Group %in% ignore),] %>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(sigma(t)))
p3 <- est_sh[which(est_sh$Group %in% ignore),]%>%
ggplot(aes(x = t, y = est)) +
geom_line(aes(color = Group, size = I(1))) +
geom_line(aes(x = t, y = U, color = Group), linetype = 2, size = I(1)) +
geom_line(aes(x = t, y = L, color = Group), linetype = 2, size = I(1)) +
xlab(paste0("Region", n,"  ", "t")) +
ylab(expression(xi(t)))
p <- list(p1, p2, p3)
#  p <- grid.arrange(p1,p2,p3,nrow=3)
#  ggsave(paste0("Region",n,".png"),p,path="F:/Streamflow/Plot/Fit",width=6,height=6)
return(p)
}
for (i in 1:18){
gra[[i]] <- plot_para(
est[[i]][[1]], est[[i]][[2]], est[[i]][[3]],
MOV=MOV[[i]],
Region=Region_list[[i]],
n=i,ignore = c("double_fit","single_fit")
)
}
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
