"0","source(""F:/Extre/Codes/Functions.R"")"
"0","## extraction of events"
"0","data <- data %>% select(Date, Q)"
"0","data$station <- rep(new$site_no,each = 3680)"
"0","data <- data %>% spread(station, Q)"
"0",""
"0","StsChos <- c(1:27)"
"0","NoSt <- length(StsChos)"
"0",""
"0","Years <- unique(as.numeric(substr(data$Date,1,4)))"
"0","StNames <- as.character(StsChos)"
"0","YearsWithEvent <- numeric()"
"0","AllEvMat <- matrix(0,length(StNames),1)"
"0","AllRes <- list()"
"0","for (i in 1:length(Years)){"
"0","  # events in the i^th year at each station"
"0","  Res <- ObtainMultVarEvents(TSs=data,U=0.1,Lag=4,Year=Years[i],StNames=StNames,Plotting=0,mfrow=c(NoSt,1))  ## For Censored Likelihood"
"0","  Events <- Res$AllEvMat"
"0","  Locations <- Res$Location"
"0","  if (length(Events)>0) {"
"0","    YearsWithEvent <- c(YearsWithEvent,rep(Years[i],dim(Events)[2]))"
"0","    AllEvMat <- cbind(AllEvMat,Events)"
"0","  }"
"0","  AllRes[[i]] <- Res "
"0","}"
"0",""
"0","DataEvents <- t(AllEvMat[,-1])"
"0","rownames(DataEvents) <- YearsWithEvent"
